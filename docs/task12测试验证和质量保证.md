# ä»»åŠ¡12: æµ‹è¯•éªŒè¯å’Œè´¨é‡ä¿è¯

- [ ] 12. æµ‹è¯•éªŒè¯å’Œè´¨é‡ä¿è¯
  - [ ] 12.1 å®ç°å•å…ƒæµ‹è¯•å’Œæ¨¡å—æµ‹è¯•
    - ç¼–å†™å„ç¡¬ä»¶é©±åŠ¨çš„å•å…ƒæµ‹è¯•ä»£ç 
    - å®ç°åŠŸèƒ½æ¨¡å—çš„é›†æˆæµ‹è¯•ç”¨ä¾‹
    - æ·»åŠ è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶å’Œå·¥å…·
    - åˆ›å»ºæµ‹è¯•æŠ¥å‘Šå’Œè¦†ç›–ç‡åˆ†æ
    - _éœ€æ±‚: æ‰€æœ‰åŠŸèƒ½éªŒè¯_

    **å¼€å‘å‰ææ¡ä»¶ï¼š**
    - âœ… æ‰€æœ‰åŠŸèƒ½æ¨¡å—å·²å®Œæˆå¼€å‘
    - âœ… ç³»ç»Ÿé›†æˆå·²å®Œæˆ
    - âœ… æµ‹è¯•ç¯å¢ƒå·²æ­å»º

    **å¿…éœ€å‡†å¤‡ææ–™ï¼š**
    - ğŸ“‹ æµ‹è¯•ç”¨ä¾‹è®¾è®¡æ–‡æ¡£
    - ğŸ“‹ è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶
    - ğŸ“‹ æµ‹è¯•æ•°æ®å’ŒåŸºå‡†
    - ğŸ“‹ è¦†ç›–ç‡åˆ†æå·¥å…·
    - ğŸ“‹ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

    **å…·ä½“å®ç°å†…å®¹ï¼š**
    ```c
    // test/test_framework.h
    #define TEST_ASSERT(condition) \
        do { \
            if (!(condition)) { \
                ESP_LOGE("TEST", "Assertion failed: %s at %s:%d", #condition, __FILE__, __LINE__); \
                return ESP_FAIL; \
            } \
        } while(0)

    typedef struct {
        const char* name;
        esp_err_t (*test_func)(void);
        bool enabled;
    } test_case_t;

    esp_err_t run_all_tests(void);
    
    // test/test_framework.c
    static test_case_t test_cases[] = {
        {"GPIO Configuration Test", test_gpio_config, true},
        {"I2S Driver Test", test_i2s_driver, true},
        {"LCD Driver Test", test_lcd_driver, true},
        {"Button Driver Test", test_button_driver, true},
        {"WiFi Connection Test", test_wifi_connection, true},
        {"WebSocket Communication Test", test_websocket_comm, true},
        {"RGB LED Test", test_rgb_led, true},
        {"Audio System Test", test_audio_system, true},
        {"System Integration Test", test_system_integration, true}
    };

    esp_err_t run_all_tests(void) {
        int total_tests = sizeof(test_cases) / sizeof(test_case_t);
        int passed_tests = 0;
        
        ESP_LOGI("TEST", "Starting test suite with %d tests", total_tests);
        
        for (int i = 0; i < total_tests; i++) {
            if (!test_cases[i].enabled) continue;
            
            ESP_LOGI("TEST", "Running test: %s", test_cases[i].name);
            
            if (test_cases[i].test_func() == ESP_OK) {
                ESP_LOGI("TEST", "âœ“ %s PASSED", test_cases[i].name);
                passed_tests++;
            } else {
                ESP_LOGE("TEST", "âœ— %s FAILED", test_cases[i].name);
            }
        }
        
        ESP_LOGI("TEST", "Test Results: %d/%d tests passed", passed_tests, total_tests);
        return (passed_tests == total_tests) ? ESP_OK : ESP_FAIL;
    }
    ```

    **è¯¦ç»†ä»»åŠ¡å†…å®¹ï¼š**
    - åˆ›å»ºtest_framework.hå®šä¹‰æµ‹è¯•æ¡†æ¶æ¥å£å’Œæ–­è¨€å®
    - å®ç°test_framework.cåŒ…å«æµ‹è¯•æ‰§è¡Œå¼•æ“å’Œç»“æœç»Ÿè®¡
    - ç¼–å†™ç¡¬ä»¶é©±åŠ¨å•å…ƒæµ‹è¯•ï¼šGPIOã€I2Sã€SPIã€ADCã€RGB LEDé©±åŠ¨æµ‹è¯•
    - å®ç°åŠŸèƒ½æ¨¡å—æµ‹è¯•ï¼šéŸ³é¢‘é‡‡é›†æ’­æ”¾ã€LCDæ˜¾ç¤ºã€æŒ‰é”®è¾“å…¥ã€WiFiè¿æ¥æµ‹è¯•
    - åˆ›å»ºé›†æˆæµ‹è¯•ç”¨ä¾‹ï¼šæ¨¡å—é—´é€šä¿¡ã€æ•°æ®æµè½¬ã€çŠ¶æ€åŒæ­¥æµ‹è¯•
    - å®ç°è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ï¼šæ”¯æŒæ‰¹é‡æµ‹è¯•æ‰§è¡Œå’Œç»“æœæ”¶é›†
    - æ·»åŠ æµ‹è¯•è¦†ç›–ç‡åˆ†æï¼šä»£ç è¦†ç›–ç‡ç»Ÿè®¡å’ŒæŠ¥å‘Šç”Ÿæˆ
    - åˆ›å»ºæµ‹è¯•æ•°æ®ç®¡ç†ï¼šæµ‹è¯•ç”¨ä¾‹æ•°æ®ã€é¢„æœŸç»“æœã€å®é™…ç»“æœå¯¹æ¯”

    **éªŒæ”¶æ ‡å‡†ï¼š**
    - å•å…ƒæµ‹è¯•è¦†ç›–ç‡â‰¥85%ï¼Œæ‰€æœ‰å…³é”®å‡½æ•°éƒ½æœ‰æµ‹è¯•ç”¨ä¾‹
    - é›†æˆæµ‹è¯•èƒ½å¤ŸéªŒè¯æ¨¡å—é—´åä½œæ­£å¸¸ï¼Œæ— æ¥å£å†²çª
    - è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ç¨³å®šï¼Œèƒ½å¤Ÿæ— äººå€¼å®ˆæ‰§è¡Œæµ‹è¯•
    - æµ‹è¯•æŠ¥å‘Šè¯¦ç»†å®Œæ•´ï¼ŒåŒ…å«é€šè¿‡ç‡ã€å¤±è´¥åŸå› ã€æ€§èƒ½æŒ‡æ ‡
    - æµ‹è¯•æ‰§è¡Œæ—¶é—´åˆç†ï¼Œå®Œæ•´æµ‹è¯•å¥—ä»¶æ‰§è¡Œæ—¶é—´<30åˆ†é’Ÿ
    - æµ‹è¯•ç»“æœå¯é‡ç°ï¼Œç›¸åŒç¯å¢ƒä¸‹æµ‹è¯•ç»“æœä¸€è‡´

  - [ ] 12.2 å®ç°ç³»ç»Ÿå‹åŠ›æµ‹è¯•å’Œç¨³å®šæ€§éªŒè¯
    - ç¼–å†™é•¿æ—¶é—´è¿è¡Œå’Œå‹åŠ›æµ‹è¯•ä»£ç 
    - å®ç°å†…å­˜æ³„æ¼å’Œèµ„æºè€—å°½æ£€æµ‹
    - æ·»åŠ å¼‚å¸¸æƒ…å†µæ¨¡æ‹Ÿå’Œæ¢å¤æµ‹è¯•
    - åˆ›å»ºç¨³å®šæ€§æŠ¥å‘Šå’Œé—®é¢˜è·Ÿè¸ª
    - _éœ€æ±‚: ç³»ç»Ÿç¨³å®šæ€§éªŒè¯_

    **å¼€å‘å‰ææ¡ä»¶ï¼š**
    - âœ… ä»»åŠ¡12.1 å•å…ƒæµ‹è¯•å’Œæ¨¡å—æµ‹è¯•å·²å®Œæˆ
    - âœ… ç³»ç»ŸåŸºæœ¬åŠŸèƒ½ç¨³å®š
    - âœ… å‹åŠ›æµ‹è¯•ç¯å¢ƒå·²å‡†å¤‡

    **å¿…éœ€å‡†å¤‡ææ–™ï¼š**
    - ğŸ“‹ å‹åŠ›æµ‹è¯•è®¾è®¡æ–¹æ¡ˆ
    - ğŸ“‹ ç¨³å®šæ€§æµ‹è¯•æ ‡å‡†
    - ğŸ“‹ å†…å­˜æ³„æ¼æ£€æµ‹å·¥å…·
    - ğŸ“‹ å¼‚å¸¸æ¨¡æ‹Ÿæµ‹è¯•ç”¨ä¾‹
    - ğŸ“‹ ç¨³å®šæ€§æŠ¥å‘Šæ¨¡æ¿

    **è¯¦ç»†ä»»åŠ¡å†…å®¹ï¼š**
    - åˆ›å»ºstress_test.hå®šä¹‰å‹åŠ›æµ‹è¯•æ¥å£å’Œé…ç½®å‚æ•°
    - å®ç°stress_test.cåŒ…å«å„ç§å‹åŠ›æµ‹è¯•åœºæ™¯å’Œç›‘æ§å‡½æ•°
    - ç¼–å†™é•¿æ—¶é—´è¿è¡Œæµ‹è¯•ï¼šè¿ç»­è¿è¡Œ72å°æ—¶ï¼Œç›‘æ§ç³»ç»Ÿç¨³å®šæ€§
    - å®ç°é«˜è´Ÿè½½å‹åŠ›æµ‹è¯•ï¼šåŒæ—¶è¿›è¡ŒéŸ³é¢‘å½•æ”¾ã€LCDåŠ¨ç”»ã€ç½‘ç»œé€šä¿¡
    - æ·»åŠ å†…å­˜æ³„æ¼æ£€æµ‹ï¼šç›‘æ§å †å†…å­˜ä½¿ç”¨ï¼Œæ£€æµ‹å†…å­˜æ³„æ¼å’Œç¢ç‰‡åŒ–
    - å®ç°èµ„æºè€—å°½æµ‹è¯•ï¼šæ¨¡æ‹Ÿå†…å­˜ä¸è¶³ã€ä»»åŠ¡æ ˆæº¢å‡ºã€é˜Ÿåˆ—æ»¡ç­‰æƒ…å†µ
    - åˆ›å»ºå¼‚å¸¸æ¢å¤æµ‹è¯•ï¼šæ¨¡æ‹Ÿç¡¬ä»¶æ•…éšœã€ç½‘ç»œä¸­æ–­ã€ç”µæºå¼‚å¸¸ç­‰
    - å®ç°ç¨³å®šæ€§ç›‘æ§ï¼šå®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€ï¼Œè®°å½•å¼‚å¸¸å’Œæ¢å¤æƒ…å†µ

    **éªŒæ”¶æ ‡å‡†ï¼š**
    - é•¿æ—¶é—´è¿è¡Œæµ‹è¯•é€šè¿‡ï¼š72å°æ—¶è¿ç»­è¿è¡Œæ— å´©æºƒæˆ–é‡å¯
    - å†…å­˜ä½¿ç”¨ç¨³å®šï¼šé•¿æ—¶é—´è¿è¡Œåå†…å­˜ä½¿ç”¨ç‡å¢é•¿<5%
    - å‹åŠ›æµ‹è¯•é€šè¿‡ï¼šé«˜è´Ÿè½½ä¸‹ç³»ç»Ÿå“åº”æ­£å¸¸ï¼Œæ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
    - å¼‚å¸¸æ¢å¤æœ‰æ•ˆï¼š90%çš„å¼‚å¸¸æƒ…å†µèƒ½å¤Ÿè‡ªåŠ¨æ¢å¤
    - èµ„æºç®¡ç†è‰¯å¥½ï¼šæ— å†…å­˜æ³„æ¼ã€ä»»åŠ¡æ ˆæº¢å‡ºç­‰èµ„æºé—®é¢˜
    - ç¨³å®šæ€§æŠ¥å‘Šå®Œæ•´ï¼šè¯¦ç»†è®°å½•æµ‹è¯•è¿‡ç¨‹å’Œé—®é¢˜åˆ†æ

  - [ ] 12.3 å®ç°ç”¨æˆ·ä½“éªŒæµ‹è¯•å’Œä¼˜åŒ–
    - ç¼–å†™ç”¨æˆ·äº¤äº’å“åº”æ—¶é—´æµ‹è¯•ä»£ç 
    - å®ç°ç•Œé¢æµç•…åº¦å’ŒåŠ¨ç”»æ€§èƒ½æµ‹è¯•
    - æ·»åŠ ç”¨æˆ·æ“ä½œæµç¨‹å’Œæ˜“ç”¨æ€§éªŒè¯
    - åˆ›å»ºç”¨æˆ·ä½“éªŒæŠ¥å‘Šå’Œæ”¹è¿›å»ºè®®
    - _éœ€æ±‚: ç”¨æˆ·ä½“éªŒä¼˜åŒ–_

    **å¼€å‘å‰ææ¡ä»¶ï¼š**
    - âœ… ä»»åŠ¡12.2 ç³»ç»Ÿå‹åŠ›æµ‹è¯•å’Œç¨³å®šæ€§éªŒè¯å·²å®Œæˆ
    - âœ… ç”¨æˆ·ç•Œé¢åŠŸèƒ½å®Œæ•´
    - âœ… ç”¨æˆ·ä½“éªŒæµ‹è¯•æ ‡å‡†å·²ç¡®è®¤

    **å¿…éœ€å‡†å¤‡ææ–™ï¼š**
    - ğŸ“‹ ç”¨æˆ·ä½“éªŒæµ‹è¯•è§„èŒƒ
    - ğŸ“‹ å“åº”æ—¶é—´åŸºå‡†æ ‡å‡†
    - ğŸ“‹ ç•Œé¢æµç•…åº¦æµ‹è¯•å·¥å…·
    - ğŸ“‹ æ˜“ç”¨æ€§è¯„ä¼°æ ‡å‡†
    - ğŸ“‹ ç”¨æˆ·ä½“éªŒæŠ¥å‘Šæ¨¡æ¿

    **è¯¦ç»†ä»»åŠ¡å†…å®¹ï¼š**
    - åˆ›å»ºux_test.hå®šä¹‰ç”¨æˆ·ä½“éªŒæµ‹è¯•æ¥å£å’Œè¯„ä¼°æ ‡å‡†
    - å®ç°ux_test.cåŒ…å«äº¤äº’å“åº”æµ‹è¯•å’Œæ€§èƒ½è¯„ä¼°å‡½æ•°
    - ç¼–å†™å“åº”æ—¶é—´æµ‹è¯•ï¼šæŒ‰é”®å“åº”ã€LCDæ›´æ–°ã€éŸ³é¢‘æ’­æ”¾å»¶è¿Ÿæµ‹è¯•
    - å®ç°ç•Œé¢æµç•…åº¦æµ‹è¯•ï¼šåŠ¨ç”»å¸§ç‡ã€ç•Œé¢åˆ‡æ¢ã€æ»šåŠ¨æ€§èƒ½æµ‹è¯•
    - æ·»åŠ æ“ä½œæµç¨‹æµ‹è¯•ï¼šWiFié…ç½®ã€éŸ³é‡è°ƒèŠ‚ã€å½•éŸ³æ’­æ”¾ç­‰å®Œæ•´æµç¨‹
    - åˆ›å»ºæ˜“ç”¨æ€§è¯„ä¼°ï¼šæ“ä½œæ­¥éª¤å¤æ‚åº¦ã€é”™è¯¯æç¤ºæ¸…æ™°åº¦ã€å­¦ä¹ æˆæœ¬
    - å®ç°æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼šä¸è®¾è®¡ç›®æ ‡å¯¹æ¯”ï¼Œè¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
    - ç”Ÿæˆç”¨æˆ·ä½“éªŒæŠ¥å‘Šï¼šåŒ…å«æµ‹è¯•ç»“æœã€é—®é¢˜åˆ†æã€ä¼˜åŒ–å»ºè®®

    **éªŒæ”¶æ ‡å‡†ï¼š**
    - å“åº”æ—¶é—´è¾¾æ ‡ï¼šæŒ‰é”®å“åº”<50msï¼ŒLCDæ›´æ–°<200msï¼ŒéŸ³é¢‘å»¶è¿Ÿ<100ms
    - ç•Œé¢æµç•…åº¦è‰¯å¥½ï¼šåŠ¨ç”»å¸§ç‡â‰¥15fpsï¼Œç•Œé¢åˆ‡æ¢æ— å¡é¡¿
    - æ“ä½œæµç¨‹ç®€æ´ï¼šä¸»è¦åŠŸèƒ½æ“ä½œæ­¥éª¤â‰¤3æ­¥ï¼Œé”™è¯¯æç¤ºæ¸…æ™°
    - ç”¨æˆ·ä½“éªŒè¯„åˆ†â‰¥80åˆ†ï¼ˆåŸºäºé¢„å®šä¹‰è¯„ä¼°æ ‡å‡†ï¼‰
    - æ€§èƒ½ä¼˜åŒ–æœ‰æ•ˆï¼šå…³é”®æŒ‡æ ‡ç›¸æ¯”åˆç‰ˆæå‡â‰¥20%
    - æ”¹è¿›å»ºè®®å®ç”¨ï¼šæä¾›å…·ä½“å¯è¡Œçš„ç”¨æˆ·ä½“éªŒä¼˜åŒ–æ–¹æ¡ˆ

## å®ç°è¯´æ˜

### å¼€å‘ç¯å¢ƒé…ç½®
åœ¨å¼€å§‹ä»»ä½•ç¼–ç ä»»åŠ¡ä¹‹å‰ï¼Œè¯·ç¡®ä¿ï¼š
1. ESP-IDF v5.4.1å·²æ­£ç¡®å®‰è£…åœ¨D:/Espressif/
2. ç›®æ ‡èŠ¯ç‰‡å·²è®¾ç½®ä¸ºESP32-C6
3. å¼€å‘æ¿å·²è¿æ¥å¹¶å¯æ­£å¸¸çƒ§å½•

### ç¼–ç è§„èŒƒ
- ä½¿ç”¨Cè¯­è¨€ç¼–å†™æ‰€æœ‰ä»£ç 
- éµå¾ªESP-IDFç¼–ç è§„èŒƒå’Œæœ€ä½³å®è·µ
- æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½è¦åŒ…å«é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º
- æ‰€æœ‰å…¬å…±æ¥å£éƒ½è¦æœ‰è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜

### æµ‹è¯•è¦æ±‚
- æ¯ä¸ªä»»åŠ¡å®Œæˆåéƒ½è¦è¿›è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•
- å…³é”®åŠŸèƒ½è¦ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹
- é›†æˆæµ‹è¯•è¦éªŒè¯æ¨¡å—é—´çš„åä½œæ­£å¸¸
- æ€§èƒ½æµ‹è¯•è¦æ»¡è¶³è®¾è®¡æ–‡æ¡£ä¸­çš„æŒ‡æ ‡è¦æ±‚

### æ–‡æ¡£è¦æ±‚
- æ¯ä¸ªç»„ä»¶éƒ½è¦æœ‰README.mdè¯´æ˜æ–‡æ¡£
- é‡è¦çš„è®¾è®¡å†³ç­–è¦è®°å½•åœ¨ä»£ç æ³¨é‡Šä¸­
- APIæ¥å£è¦æœ‰å®Œæ•´çš„å‡½æ•°è¯´æ˜
- é…ç½®å‚æ•°è¦æœ‰è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜